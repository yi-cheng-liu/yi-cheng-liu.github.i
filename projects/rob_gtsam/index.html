<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> GTSAM | Yi-Cheng </title> <meta name="author" content="Yi-Cheng Liu"> <meta name="description" content="Personal profolio site. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://yi-cheng-liu.github.io/projects/rob_gtsam/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Yi-Cheng </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">GTSAM</h1> <p class="post-description"></p> </header> <article> <p>The code implements two algorithms, batch and incremental, for 2D trajectory optimization using gtsam library. The input data is obtained from a g2o file containing the 2D poses and edges between them. The batch solution uses Gauss-Newton method to optimize the graph, while the incremental solution uses iSAM2 algorithm to optimize the graph incrementally in every timestep. A prior factor model is added to the graph to improve optimization performance. The optimized trajectories are then plotted and saved as figures. The code also includes a function to convert the optimized poses from gtsam Pose2 objects to numpy arrays for easier plotting. Overall, this code provides a basic implementation for 2D trajectory optimization using gtsam library.</p> <p><img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> <a href="https://github.com/yi-cheng-liu/Mobile_robot/tree/main/SLAM_with_GTSAM" rel="external nofollow noopener" target="_blank">Github repo</a></p> <h2 id="2-dimentional-graph-slam">2-Dimentional Graph SLAM</h2> <h3 id="batch-solution">Batch Solution</h3> <p>Input : file name</p> <p>Output: result</p> <p>The goal is to optimize the trajectory with the batch method using the input g2o file “<code class="language-plaintext highlighter-rouge">input_INTEL_g2o.g2o</code>”. There are mainly five steps, which are reading the data, add a prior factor model, build a optimizer with the Gauss-Newton method, optimize the graph and initial to a <code class="language-plaintext highlighter-rouge">gtsam.Pose2</code> structure, and plot the x, y position.</p> <p>The predefined <code class="language-plaintext highlighter-rouge">gtsam.readG2o(file, is3D)</code> function phrases a G2o file and stores the measurements into a <code class="language-plaintext highlighter-rouge">gtsam.NonlinearFactorGraph</code> structure and the initial estimate into a <code class="language-plaintext highlighter-rouge">gtsam.Values</code> structure. The function set a flag ‘is3D’ to false since it’s a 2D graph.</p> <p>The following step is to add a prior factor to a existing graph. We have to define a noiseModel first, build a factorPose2 with the noiseModel and add the factorPose2 to the graph. Noisemodel can be build with <code class="language-plaintext highlighter-rouge">Diagnoal</code>, <code class="language-plaintext highlighter-rouge">Gaussian</code>, <code class="language-plaintext highlighter-rouge">Isotropic</code>, <code class="language-plaintext highlighter-rouge">Constrained</code>, and <code class="language-plaintext highlighter-rouge">Unit</code>, and I choose the <code class="language-plaintext highlighter-rouge">gtsam.noiseModel.Diagonal</code>.Variances() method with specifing the variances of the 33 matrix using <code class="language-plaintext highlighter-rouge">np.array([1e-6, 1e-6, 1e-4])</code>. The prior factor have to be created subsequently with <code class="language-plaintext highlighter-rouge">gtsam.PriorFactorPose2(0, gtsam.Pose2(), priorModel)</code> to be added to the graph. Then we can add the <code class="language-plaintext highlighter-rouge">priorFactorPose2</code> to the graph with measurements.</p> <p>We want to solve the non-linear least square problem with the Gauss-Newton method. Thus, we give the <code class="language-plaintext highlighter-rouge">gtsam.GaussNewtonOptimizer(graph, initial, params)</code> function with the measurement graph with priorFactor, the initial estimate, and configuration parameters with <code class="language-plaintext highlighter-rouge">gtsam.GaussNewtonParams()</code>. After optimizing with the Gauss-Newton method, the <code class="language-plaintext highlighter-rouge">gtsam.optimize()</code> method is used for building the graph, initial to a <code class="language-plaintext highlighter-rouge">Pose2</code> structure. With the <code class="language-plaintext highlighter-rouge">Pose2</code> structure, I define a <code class="language-plaintext highlighter-rouge">pose2_to_array(result)</code> function which change the <code class="language-plaintext highlighter-rouge">Pose2</code> structure to an np.array and extract the x, y values for plotting the initial and result.</p> <h3 id="incremental-solution">Incremental Solution</h3> <p>Input: poses (Nx4) <code class="language-plaintext highlighter-rouge">[i x y theta]</code>           edges (Nx11) <code class="language-plaintext highlighter-rouge">[i j x y theta info(x, y, theta)]</code> Output: result</p> <p>The goal is to optimize the trajectory with the incremental method using the input g2o file “<code class="language-plaintext highlighter-rouge">input_INTEL_g2o.g2o</code>”. There are mainly seven steps, which are reading the data, initialize <code class="language-plaintext highlighter-rouge">ISAM2</code>, add a prior factor model, calculate the information matrix for the moisemodel, update the isam with the current graph and initial estimate, calculate the estimate every timestep and convert to a gtsam.Pose2 structure, and plot the x, y position.</p> <p>After reading the data through the <code class="language-plaintext highlighter-rouge">readG2OFile2d(file_name)</code> function, we can initialize the isam with <code class="language-plaintext highlighter-rouge">gtsam.ISAM2(params)</code> given the configuration parameters set by <code class="language-plaintext highlighter-rouge">gtsam.ISAM2Params()</code>.</p> <p>The following step is to add a prior factor to a new graph. We have to define a noiseModel first, build a factorPose2 with the noiseModel and add the factorPose2 to the graph. Noisemodel can be build with <code class="language-plaintext highlighter-rouge">Diagnoal</code>, <code class="language-plaintext highlighter-rouge">Gaussian</code>, <code class="language-plaintext highlighter-rouge">Isotropic</code>, <code class="language-plaintext highlighter-rouge">Constrained</code>, and <code class="language-plaintext highlighter-rouge">Unit</code>, and I choose the <code class="language-plaintext highlighter-rouge">gtsam.noiseModel.Diagonal.Variances() method with specifing the variances of the 33 matrix using np.array([1e-6, 1e-6, 1e-4])</code>. The x, y, theta are 0 with the 0-index and can be added to the prior factor with the <code class="language-plaintext highlighter-rouge">Pose2</code> structure. The prior factor have to be created subsequently with <code class="language-plaintext highlighter-rouge">gtsam.PriorFactorPose2(0, gtsam.Pose2(x, y, theta), priorModel)</code> to be added to the graph. Then we can add the priorFactorPose2 to the graph, and insert the <code class="language-plaintext highlighter-rouge">pose2(x, y, theta)</code> to the initial_estimate.</p> <p>After adding the priorFactor, we have to update the isam with <code class="language-plaintext highlighter-rouge">isam.update(graph, initial_estimate)</code> and calculate the estimate with <code class="language-plaintext highlighter-rouge">calculateEstimate()</code> which will happen in every timestep.</p> <p>Starting from now, we steps will be repeated until the data in finish calculating. The previously calculated pose was inserted into the initial_estimate with the corresponding index. Detailed data including index, x, y, and data for information matrix are extracted from the edges. The noise model was build with Information matrix was build with <code class="language-plaintext highlighter-rouge">gtsam.noiseModel.Gaussian.Covariance(cov)</code> which cov was the inverse of the information matrix. The FactorPose2 have to be created subsequently with <code class="language-plaintext highlighter-rouge">gtsam.BetweenFactorPose2(int(ide1), int(ide2), gtsam.Pose2(dx, dy, dtheta), model)</code> to be added to the graph.</p> <p>After the iterations, we would return the result with the Pose2 structure. The <code class="language-plaintext highlighter-rouge">pose2_to_array(result)</code> function would change the <code class="language-plaintext highlighter-rouge">Pose2</code> structure to an np.array and extract the x, y values for plotting the initial and result.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <div class="center-justify"></div> Batch <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/rob_gtsam/2D_batch_trajectory_optimization-480.webp 480w,/assets/img/rob_gtsam/2D_batch_trajectory_optimization-800.webp 800w,/assets/img/rob_gtsam/2D_batch_trajectory_optimization-1400.webp 1400w," sizes="120vw" type="image/webp"></source> <img src="/assets/img/rob_gtsam/2D_batch_trajectory_optimization.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Cosmos Original" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> Incremental <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/rob_gtsam/2D_incremental_trajectory_optimization-480.webp 480w,/assets/img/rob_gtsam/2D_incremental_trajectory_optimization-800.webp 800w,/assets/img/rob_gtsam/2D_incremental_trajectory_optimization-1400.webp 1400w," sizes="120vw" type="image/webp"></source> <img src="/assets/img/rob_gtsam/2D_incremental_trajectory_optimization.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Cosmos Quantize Naive" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="3-dimentinoal-graph-slam">3-Dimentinoal Graph SLAM</h2> <p>There are two kinds of solution, Batch solution and Incremental solution.</p> <h3 id="batch-solution-1">Batch Solution</h3> <p>Input: file name</p> <p>Output: result</p> <p>The goal is to optimize the trajectory with the batch method using the input g2o file “<code class="language-plaintext highlighter-rouge">parking-garage.g2o</code>”. There are mainly five steps, which are reading the data, add a prior factor model, build a optimizer with the Gauss-Newton method, optimize the graph and initial to a <code class="language-plaintext highlighter-rouge">gtsam.Pose3</code> structure, and plot the x, y, z position. The steps are the same as the 3D batch solutions, but we would have a dataset with 3-dimentional measurements, which instead of <code class="language-plaintext highlighter-rouge">Pose3</code> structure, we use Pose3 structure.</p> <p>The predefined <code class="language-plaintext highlighter-rouge">gtsam.readG2o(file, is3D)</code> function phrases a G2o file and stores the measurements into a <code class="language-plaintext highlighter-rouge">gtsam.NonlinearFactorGraph</code> structure and the initial estimate into a <code class="language-plaintext highlighter-rouge">gtsam.Values</code> structure. The function set a flag ‘is3D’ to true since it’s a 3D graph.</p> <p>The following step is to add a prior factor to a existing graph. We have to define a noiseModel first, build a <code class="language-plaintext highlighter-rouge">factorPose3</code> with the noiseModel and add the factorPose3 to the graph. Noisemodel can be build with <code class="language-plaintext highlighter-rouge">Diagnoal</code>, <code class="language-plaintext highlighter-rouge">Gaussian</code>, <code class="language-plaintext highlighter-rouge">Isotropic</code>, <code class="language-plaintext highlighter-rouge">Constrained</code>, and <code class="language-plaintext highlighter-rouge">Unit</code>, and I choose the <code class="language-plaintext highlighter-rouge">gtsam.noiseModel.Diagonal.Variances()</code> method with specifing the variances of the 66 matrix using <code class="language-plaintext highlighter-rouge">np.array([1e-6, 1e-6, 1e-6, 1e-4, 1e-4, 1e-4])</code>. The prior factor have to be created subsequently with <code class="language-plaintext highlighter-rouge">gtsam.PriorFactorPose3(0, gtsam.Pose3(), priorModel)</code> to be added to the graph. Then we can add the <code class="language-plaintext highlighter-rouge">priorFactorPose3</code> to the graph with measurements.</p> <p>We want to solve the non-linear least square problem with the Gauss-Newton method. Thus, we give the <code class="language-plaintext highlighter-rouge">gtsam.GaussNewtonOptimizer(graph, initial, params)</code> function with the measurements graph with priorFactor, the initial estimate, and configuration parameters with <code class="language-plaintext highlighter-rouge">gtsam.GaussNewtonParams()</code>. After optimizing with the Gauss-Newton method, the <code class="language-plaintext highlighter-rouge">gtsam.optimize()</code> method is used for building the graph, initial to a Pose3 structure. With the Pose3 structure, I define a <code class="language-plaintext highlighter-rouge">pose3_to_array(result)</code> function which change the Pose3 structure to an np.array and extract the x, y values for plotting the initial and result.</p> <h3 id="incremental-solition">Incremental Solition</h3> <p>Input: poses (<code class="language-plaintext highlighter-rouge">Nx8</code>) <code class="language-plaintext highlighter-rouge">[i x y theta]</code>           edges (<code class="language-plaintext highlighter-rouge">Nx30</code>) <code class="language-plaintext highlighter-rouge">[i j x y theta info(x, y, theta)]</code> Output: result</p> <p>The goal is to optimize the trajectory with the incremental method using the input g2o file “<code class="language-plaintext highlighter-rouge">parking-garage.g2o</code>”. There are mainly seven steps, which are reading the data, initialize ISAM2, add a prior factor model, calculate the information matrix for the moisemodel, update the isam with the current graph and initial estimate, calculate the estimate every timestep and convert to a <code class="language-plaintext highlighter-rouge">gtsam.Pose3</code> structure, and plot the x, y, z position.</p> <p>After reading the data through the <code class="language-plaintext highlighter-rouge">readG2OFile3d(file_name)</code> function, we can initialize the isam with <code class="language-plaintext highlighter-rouge">gtsam.ISAM2(params)</code> given the configuration parameters set by <code class="language-plaintext highlighter-rouge">gtsam.ISAM2Params()</code>.</p> <p>The following step is to add a prior factor to a new graph. We have to define a noiseModel first, build a factorPose3 with the noiseModel and add the factorPose3 to the graph. Noisemodel can be build with <code class="language-plaintext highlighter-rouge">Diagnoal</code>, <code class="language-plaintext highlighter-rouge">Gaussian</code>, <code class="language-plaintext highlighter-rouge">Isotropic</code>, <code class="language-plaintext highlighter-rouge">Constrained</code>, and <code class="language-plaintext highlighter-rouge">Unit</code>, and I choose the gtsam.noiseModel.Diagonal.Variances() method with specifing the variances of the 66 matrix using <code class="language-plaintext highlighter-rouge">np.array([1e-6, 1e-6, 1e-6, 1e-6, 1e-4, 1e-4])</code>. The priorPose named prior can be calculated through the quaternion rotation matrix and transition matrix with <code class="language-plaintext highlighter-rouge">quaternion_rotation_matrix(qw, qx, qy, qz)</code> and <code class="language-plaintext highlighter-rouge">np.array([x, y, z]).reshape((3, 1))</code> respectively. The prior factor have to be created subsequently with <code class="language-plaintext highlighter-rouge">gtsam.PriorFactorPose3(0, prior, priorModel)</code> to be added to the graph. Then we can add the <code class="language-plaintext highlighter-rouge">priorFactorPose3</code> to the graph, and insert the pose to the initial_estimate.</p> <p>After adding the priorFactor, we have to update the isam with <code class="language-plaintext highlighter-rouge">isam.update(graph, initial_estimate)</code> and calculate the estimate with <code class="language-plaintext highlighter-rouge">calculateEstimate()</code> which will happen in every timestep.</p> <p>Starting from now, we steps will be repeated until the data in finish calculating. The previously calculated pose was inserted into the initial_estimate with the corresponding index. Detailed data including index, x, y, z, qx, qy, qz, qw and data for information matrix are extracted from the edges. The noise model was build with Information matrix was build with <code class="language-plaintext highlighter-rouge">gtsam.noiseModel.Gaussian.Covariance(cov)</code> which cov was the inverse of the information matrix. The currentPose named pose can be calculated through the quaternion rotation matrix and transition matrix with <code class="language-plaintext highlighter-rouge">quaternion_rotation_matrix(qw, qx, qy, qz)</code> and <code class="language-plaintext highlighter-rouge">np.array([x, y, z]).reshape((3, 1))</code> respectively. The FactorPose3 have to be created subsequently with <code class="language-plaintext highlighter-rouge">gtsam.BetweenFactorPose3(int(ide1), int(ide2), pose, model)</code> to be added to the graph.</p> <p>After the iterations, we would return the result with the <code class="language-plaintext highlighter-rouge">Pose3</code> structure. The <code class="language-plaintext highlighter-rouge">pose3_to_array(result)</code> function would change the <code class="language-plaintext highlighter-rouge">Pose3</code> structure to an np.array and extract the x, y, z values for plotting the initial and result.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <div class="center-justify"></div> Batch <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/rob_gtsam/3D_batch_trajectory_optimization-480.webp 480w,/assets/img/rob_gtsam/3D_batch_trajectory_optimization-800.webp 800w,/assets/img/rob_gtsam/3D_batch_trajectory_optimization-1400.webp 1400w," sizes="120vw" type="image/webp"></source> <img src="/assets/img/rob_gtsam/3D_batch_trajectory_optimization.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Cosmos Original" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> Incremental <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/rob_gtsam/3D_incremental_trajectory_optimization-480.webp 480w,/assets/img/rob_gtsam/3D_incremental_trajectory_optimization-800.webp 800w,/assets/img/rob_gtsam/3D_incremental_trajectory_optimization-1400.webp 1400w," sizes="120vw" type="image/webp"></source> <img src="/assets/img/rob_gtsam/3D_incremental_trajectory_optimization.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Cosmos Quantize Naive" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Yi-Cheng Liu. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?fcfacfb8c6281f5e68d5a7d348186eb1"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>